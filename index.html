<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Constelación de Alondra</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Georgia', serif;
            overflow: hidden;
            /* El color en el medio (50%) es #1a1a2e */
            background: linear-gradient(to bottom, #0a0a1a 0%, #1a1a2e 50%, #2d1b3d 100%);
            height: 100vh;
            margin: 0;
        }

        .background-image {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60%;
            background: linear-gradient(to top,
                    rgba(45, 27, 61, 0) 0%,
                    /* Transparente abajo para ver la foto */
                    rgba(26, 26, 46, 0.5) 50%,
                    /* Empieza a oscurecer */
                    #1a1a2e 100%),
                /* Color EXACTO del body a esa altura */
                url('huanchaco-pic.png') center bottom / cover no-repeat;
            z-index: 1;
            -webkit-mask-image: linear-gradient(to top, black 70%, transparent 100%);
            mask-image: linear-gradient(to top, black 70%, transparent 100%);
        }

        .background-image::before {
            content: "";
            position: absolute;
            top: -2px;
            left: 0;
            width: 100%;
            height: 50px;
            background: inherit;
            filter: blur(10px);
            z-index: 2;
        }

        .stars-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 2;
        }

        .star {
            position: absolute;
            animation: twinkle 3s infinite ease-in-out;
        }

        .star::before,
        .star::after {
            content: '';
            position: absolute;
            background: white;
            top: 50%;
            left: 50%;
        }

        .star.small::before {
            width: 0.3px;
            height: 3px;
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        .star.small::after {
            width: 3px;
            height: 0.3px;
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        .star.medium::before {
            width: 0.4px;
            height: 4px;
            box-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        .star.medium::after {
            width: 4px;
            height: 0.4px;
            box-shadow: 0 0 2px rgba(255, 255, 255, 0.5);
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        .star.large::before {
            width: 0.5px;
            height: 5px;
            box-shadow: 0 0 3px rgba(255, 255, 255, 0.6);
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        .star.large::after {
            width: 5px;
            height: 0.5px;
            box-shadow: 0 0 3px rgba(255, 255, 255, 0.6);
            transform: translate(-50%, -50%) rotate(var(--rotation, 0deg));
        }

        /* Estrellas de 6 puntas (algunas estrellas tendrán un tercer rayo) */
        .star.six-pointed::before {
            box-shadow:
                0 0 2px rgba(255, 255, 255, 0.5),
                0 -2px 0 0.3px white,
                0 2px 0 0.3px white;
        }

        .cancer-star {
            position: absolute;
            z-index: 5;
            width: 8px;
            height: 8px;
            background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 30%, rgba(255, 255, 255, 0.3) 70%, rgba(255, 255, 255, 0) 100%);
            border-radius: 50%;
            animation: cancerPulse 8s infinite ease-in-out;
        }

        .cancer-star::before,
        .cancer-star::after {
            display: none;
        }

        .constellation-line {
            position: absolute;
            height: 1px;
            /* La opacidad base es 0 para asegurar que empiecen invisibles */
            opacity: 0;
            transform-origin: left center;
            z-index: 4;
            animation: lineColorChange 8s infinite ease-in-out;
            pointer-events: none;
        }

        /* Animación ajustada para ocultar líneas cuando las estrellas son blancas */
        @keyframes lineColorChange {

            /* Fase 1: Estrellas Blancas (Inicio) -> Líneas Invisibles */
            0%,
            15% {
                opacity: 0;
                background: rgba(220, 20, 60, 0.8);
                box-shadow: none;
            }

            /* Fase 2: Estrellas Rojas -> Líneas Rojas Visibles */
            20%,
            35% {
                opacity: 0.8;
                background: rgba(220, 20, 60, 0.8);
                box-shadow: 0 0 8px rgba(220, 20, 60, 0.6), 0 0 16px rgba(220, 20, 60, 0.4);
            }

            /* Fase 3: Estrellas Blancas (Medio) -> Líneas Invisibles */
            40%,
            55% {
                opacity: 0;
                background: rgba(220, 20, 60, 0.8);
                /* Se desvanecen como rojas */
                box-shadow: none;
            }

            55.1% {
                background: rgba(50, 205, 50, 0.8);
            }

            /* Fase 4: Estrellas Verdes -> Líneas Verdes Visibles */
            60%,
            75% {
                opacity: 0.8;
                background: rgba(50, 205, 50, 0.8);
                box-shadow: 0 0 8px rgba(50, 205, 50, 0.6), 0 0 16px rgba(50, 205, 50, 0.4);
            }

            /* Fase 5: Estrellas Blancas (Final) -> Líneas Invisibles */
            80%,
            100% {
                opacity: 0;
                background: rgba(50, 205, 50, 0.8);
                /* Se desvanecen como verdes */
                box-shadow: none;
            }
        }

        @keyframes twinkle {

            0%,
            100% {
                opacity: 0.3;
                transform: scale(1);
            }

            50% {
                opacity: 1;
                transform: scale(1.2);
            }
        }

        @keyframes cancerPulse {

            0%,
            15% {
                background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 30%, rgba(255, 255, 255, 0.3) 70%, rgba(255, 255, 255, 0) 100%);
                box-shadow: 0 0 10px rgba(255, 255, 255, 1), 0 0 20px rgba(255, 255, 255, 0.8);
                transform: scale(1);
            }

            20%,
            35% {
                background: radial-gradient(circle, rgba(220, 20, 60, 1) 0%, rgba(220, 20, 60, 0.9) 30%, rgba(220, 20, 60, 0.5) 70%, rgba(220, 20, 60, 0) 100%);
                box-shadow: 0 0 20px rgba(220, 20, 60, 1), 0 0 40px rgba(220, 20, 60, 1), 0 0 60px rgba(220, 20, 60, 0.6);
                transform: scale(1.5);
            }

            40%,
            55% {
                background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 30%, rgba(255, 255, 255, 0.3) 70%, rgba(255, 255, 255, 0) 100%);
                box-shadow: 0 0 10px rgba(255, 255, 255, 1), 0 0 20px rgba(255, 255, 255, 0.8);
                transform: scale(1);
            }

            60%,
            75% {
                background: radial-gradient(circle, rgba(50, 205, 50, 1) 0%, rgba(50, 205, 50, 0.9) 30%, rgba(50, 205, 50, 0.5) 70%, rgba(50, 205, 50, 0) 100%);
                box-shadow: 0 0 20px rgba(50, 205, 50, 1), 0 0 40px rgba(50, 205, 50, 1), 0 0 60px rgba(50, 205, 50, 0.6);
                transform: scale(1.5);
            }

            80%,
            100% {
                background: radial-gradient(circle, rgba(255, 255, 255, 1) 0%, rgba(255, 255, 255, 0.9) 30%, rgba(255, 255, 255, 0.3) 70%, rgba(255, 255, 255, 0) 100%);
                box-shadow: 0 0 10px rgba(255, 255, 255, 1), 0 0 20px rgba(255, 255, 255, 0.8);
                transform: scale(1);
            }
        }

        @keyframes cancerColorChange {

            0%,
            15% {
                background: #ffffff;
                box-shadow: 0 0 6px rgba(255, 255, 255, 1), 0 0 12px rgba(255, 255, 255, 0.8);
            }

            20%,
            35% {
                background: #DC143C;
                box-shadow: 0 0 15px rgba(220, 20, 60, 1), 0 0 30px rgba(220, 20, 60, 1), 0 0 45px rgba(220, 20, 60, 0.6);
            }

            40%,
            55% {
                background: #ffffff;
                box-shadow: 0 0 6px rgba(255, 255, 255, 1), 0 0 12px rgba(255, 255, 255, 0.8);
            }

            60%,
            75% {
                background: #32CD32;
                box-shadow: 0 0 15px rgba(50, 205, 50, 1), 0 0 30px rgba(50, 205, 50, 1), 0 0 45px rgba(50, 205, 50, 0.6);
            }

            80%,
            100% {
                background: #ffffff;
                box-shadow: 0 0 6px rgba(255, 255, 255, 1), 0 0 12px rgba(255, 255, 255, 0.8);
            }
        }

        .cancer-star::before,
        .cancer-star::after {
            animation: cancerColorChange 8s infinite ease-in-out;
        }

        .cancer-star::before {
            animation: cancerColorChange 8s infinite ease-in-out;
        }

        @keyframes cancerColorChange {

            0%,
            15% {
                color: white;
            }

            20%,
            35% {
                color: #8b0000;
            }

            40%,
            55% {
                color: white;
            }

            60%,
            75% {
                color: #228B22;
            }

            80%,
            100% {
                color: white;
            }
        }

        .text-container {
            position: absolute;
            top: 25%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 4;
            text-align: center;
            width: 90%;
            max-width: 800px;
        }

        .main-text {
            font-size: clamp(1.8rem, 4vw, 3rem);
            color: #f0e6d2;
            text-shadow:
                0 0 15px rgba(240, 230, 210, 0.8),
                0 0 30px rgba(240, 230, 210, 0.5),
                3px 3px 6px rgba(0, 0, 0, 0.9);
            letter-spacing: 2px;
            line-height: 1.6;
            font-weight: 300;
        }

        .cursor {
            display: inline-block;
            width: 3px;
            height: 1.2em;
            background: #f0e6d2;
            margin-left: 5px;
            animation: blink 0.8s infinite;
            vertical-align: middle;
        }

        @keyframes blink {

            0%,
            50% {
                opacity: 1;
            }

            51%,
            100% {
                opacity: 0;
            }
        }

        @media (max-width: 768px) {
            .text-container {
                top: 30%;
            }
        }
    </style>
</head>

<body>
    <div class="background-image"></div>
    <div class="stars-container" id="starsContainer"></div>

    <div class="text-container">
        <div class="main-text" id="typedText"></div>
    </div>

    <script>
        // Generar estrellas aleatorias - todas puntitos redondos
        const starsContainer = document.getElementById('starsContainer');
        const starCount = 120;

        for (let i = 0; i < starCount; i++) {
            const star = document.createElement('div');

            // Mezcla de tamaños de puntitos
            const sizes = ['small', 'small', 'medium', 'large', 'dot', 'dot'];
            const randomSize = sizes[Math.floor(Math.random() * sizes.length)];
            star.className = `star ${randomSize}`;

            star.style.left = Math.random() * 100 + '%';
            star.style.top = Math.random() * 70 + '%';
            star.style.animationDelay = Math.random() * 3 + 's';

            starsContainer.appendChild(star);
        }

        // Posiciones de la constelación de Cáncer ajustadas
        const cancerStars = [
            { left: '5%', top: '10%' },      // Estrella 1
            { left: '35%', top: '14%' },     // Estrella 2
            { left: '50%', top: '13%' },     // Estrella 3 (centro - punto de ramificación)
            { left: '80%', top: '2%' },      // Estrella 4
            { left: '95%', top: '18%' }      // Estrella 5
        ];

        cancerStars.forEach((pos, index) => {
            const star = document.createElement('div');
            star.className = 'cancer-star';
            star.style.left = pos.left;
            star.style.top = pos.top;
            star.style.animationDelay = '0s';
            star.setAttribute('data-index', index);
            starsContainer.appendChild(star);
        });

        // --- NUEVA FUNCIÓN PRINCIPAL OPTIMIZADA ---
        // Renderiza todas las líneas de la constelación reutilizando elementos
        function renderConstellationLines() {
            // 1. Obtener posiciones actuales de las estrellas
            const stars = document.querySelectorAll('.cancer-star');
            if (stars.length === 0) return;

            const positions = Array.from(stars).map(star => {
                const rect = star.getBoundingClientRect();
                return {
                    x: rect.left + rect.width / 2,
                    y: rect.top + rect.height / 2
                };
            });

            // 2. Intentar obtener líneas existentes (en lugar de borrarlas)
            let lines = document.querySelectorAll('.constellation-line');

            // 3. Si no existen (primera vez), crearlas
            if (lines.length === 0) {
                for (let i = 0; i < 4; i++) {
                    const line = document.createElement('div');
                    line.className = 'constellation-line';
                    // Compensación de retardo: adelantamos la animación ligeramente 
                    // para coincidir con las estrellas que se crearon 100ms antes
                    line.style.animationDelay = '-0.1s';
                    starsContainer.appendChild(line);
                }
                // Refrescar la lista de líneas
                lines = document.querySelectorAll('.constellation-line');
            }

            // 4. Función auxiliar para actualizar la posición de una línea existente
            // Al modificar el estilo del objeto existente, NO se reinicia la animación CSS
            const updateLine = (line, x1, y1, x2, y2) => {
                const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);
                const angle = Math.atan2(y2 - y1, x2 - x1) * (180 / Math.PI);

                line.style.width = length + 'px';
                line.style.left = x1 + 'px';
                line.style.top = y1 + 'px';
                line.style.transform = `rotate(${angle}deg)`;
            };

            // 5. Actualizar posiciones (1->2, 2->3, 3->4, 3->5)
            if (positions.length >= 5 && lines.length >= 4) {
                updateLine(lines[0], positions[0].x, positions[0].y, positions[1].x, positions[1].y); // 1 a 2
                updateLine(lines[1], positions[1].x, positions[1].y, positions[2].x, positions[2].y); // 2 a 3
                updateLine(lines[2], positions[2].x, positions[2].y, positions[3].x, positions[3].y); // 3 a 4
                updateLine(lines[3], positions[2].x, positions[2].y, positions[4].x, positions[4].y); // 3 a 5
            }
        }

        // Ejecutar inicialmente (esperar un poco para asegurar renderizado)
        setTimeout(renderConstellationLines, 100);

        // --- LISTENER DE REDIMENSIÓN ---
        // Ejecutar cada vez que cambia el tamaño de la ventana
        window.addEventListener('resize', renderConstellationLines);


        // Efecto de escritura
        const text = "Que el poder de tu constelación guíe siempre tu camino";
        const typedTextElement = document.getElementById('typedText');
        let index = 0;

        function typeWriter() {
            if (index < text.length) {
                typedTextElement.innerHTML = text.substring(0, index + 1) + '<span class="cursor"></span>';
                index++;
                setTimeout(typeWriter, 80); // Velocidad normal de escritura
            } else {
                typedTextElement.innerHTML = text + '<span class="cursor"></span>';
            }
        }

        // Iniciar la escritura después de 1 segundo
        setTimeout(typeWriter, 1000);
    </script>
</body>

</html>